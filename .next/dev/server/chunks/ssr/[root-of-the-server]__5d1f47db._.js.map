{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 6, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/sil/Documents/Reposit%C3%B3rios/paodequeijodaira/src/lib/supabaseClient.js"],"sourcesContent":["// src/lib/supabaseClient.js\r\n\r\nimport { createClient } from '@supabase/supabase-js';\r\n\r\n// Essas vari√°veis devem estar no seu arquivo .env.local\r\nconst supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL;\r\nconst supabaseAnonKey = process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY;\r\n\r\nif (!supabaseUrl || !supabaseAnonKey) {\r\n  console.error(\"Erro: Vari√°veis do Supabase n√£o encontradas no .env.local\");\r\n}\r\n\r\nexport const supabase = createClient(supabaseUrl, supabaseAnonKey);"],"names":[],"mappings":";;;;AAAA,4BAA4B;AAE5B;;;;;;AAEA,wDAAwD;AACxD,MAAM;AACN,MAAM;AAEN;;AAIO,MAAM,WAAW,IAAA,2OAAY,EAAC,aAAa"}},
    {"offset": {"line": 30, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/sil/Documents/Reposit%C3%B3rios/paodequeijodaira/src/components/FormularioTroca.js"],"sourcesContent":["import { useState } from 'react';\r\nimport { supabase } from '../lib/supabaseClient';\r\n\r\nexport default function FormularioTroca({ pedido, onFechar }) {\r\n  const [motivo, setMotivo] = useState('Defeito de fabrica√ß√£o');\r\n  const [descricao, setDescricao] = useState('');\r\n  const [enviando, setEnviando] = useState(false);\r\n\r\n  const enviarSolicitacao = async (e) => {\r\n    e.preventDefault();\r\n    setEnviando(true);\r\n\r\n    const { error } = await supabase.from('trocas').insert([\r\n      {\r\n        pedido_id: pedido.id,\r\n        motivo: motivo,\r\n        descricao: descricao,\r\n        cliente_id: (await supabase.auth.getUser()).data.user.id\r\n      }\r\n    ]);\r\n\r\n    // Atualiza o status do pedido para que o cliente saiba que est√° em an√°lise\r\n    await supabase\r\n      .from('pedidos')\r\n      .update({ status: 'Em An√°lise de Troca' })\r\n      .eq('id', pedido.id);\r\n\r\n    if (!error) {\r\n      alert(\"Solicita√ß√£o enviada com sucesso! Analisaremos em at√© 48h.\");\r\n      onFechar();\r\n      window.location.reload(); // Atualiza a tela para mostrar o novo status\r\n    } else {\r\n      alert(\"Erro ao enviar. Tente novamente.\");\r\n    }\r\n    setEnviando(false);\r\n  };\r\n\r\n  return (\r\n    <div className=\"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50\">\r\n      <div className=\"bg-white p-8 rounded-3xl max-w-md w-full shadow-2xl\">\r\n        <h2 className=\"text-2xl font-bold mb-4 text-orange-600\">Solicitar Troca ou Devolu√ß√£o</h2>\r\n        <p className=\"text-sm text-gray-500 mb-6\">Pedido: #{pedido.id.slice(0, 8)}</p>\r\n        \r\n        <form onSubmit={enviarSolicitacao} className=\"space-y-4\">\r\n          <div>\r\n            <label className=\"block text-sm font-bold mb-1\">Motivo principal:</label>\r\n            <select \r\n              value={motivo} \r\n              onChange={(e) => setMotivo(e.target.value)}\r\n              className=\"w-full border p-3 rounded-xl bg-gray-50\"\r\n            >\r\n              <option>Defeito de fabrica√ß√£o (Camiseta/Caneca)</option>\r\n              <option>Tamanho incorreto</option>\r\n              <option>Produto danificado no transporte</option>\r\n              <option>Arrependimento (7 dias)</option>\r\n              <option>Outros</option>\r\n            </select>\r\n          </div>\r\n\r\n          <div>\r\n            <label className=\"block text-sm font-bold mb-1\">Detalhes (Opcional):</label>\r\n            <textarea \r\n              value={descricao}\r\n              onChange={(e) => setDescricao(e.target.value)}\r\n              className=\"w-full border p-3 rounded-xl h-32\"\r\n              placeholder=\"Explique o que aconteceu...\"\r\n            ></textarea>\r\n          </div>\r\n\r\n          <div className=\"flex gap-3\">\r\n            <button \r\n              type=\"button\" \r\n              onClick={onFechar}\r\n              className=\"flex-1 py-3 font-bold text-gray-500\"\r\n            >\r\n              Cancelar\r\n            </button>\r\n            <button \r\n              type=\"submit\" \r\n              disabled={enviando}\r\n              className=\"flex-1 py-3 bg-orange-600 text-white rounded-xl font-bold hover:bg-orange-700 disabled:bg-gray-400\"\r\n            >\r\n              {enviando ? 'Enviando...' : 'Enviar Pedido'}\r\n            </button>\r\n          </div>\r\n        </form>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":";;;;;AAAA;AACA;;;;;;;;AAEe,SAAS,gBAAgB,EAAE,MAAM,EAAE,QAAQ,EAAE;IAC1D,MAAM,CAAC,QAAQ,UAAU,GAAG,IAAA,+GAAQ,EAAC;IACrC,MAAM,CAAC,WAAW,aAAa,GAAG,IAAA,+GAAQ,EAAC;IAC3C,MAAM,CAAC,UAAU,YAAY,GAAG,IAAA,+GAAQ,EAAC;IAEzC,MAAM,oBAAoB,OAAO;QAC/B,EAAE,cAAc;QAChB,YAAY;QAEZ,MAAM,EAAE,KAAK,EAAE,GAAG,MAAM,iIAAQ,CAAC,IAAI,CAAC,UAAU,MAAM,CAAC;YACrD;gBACE,WAAW,OAAO,EAAE;gBACpB,QAAQ;gBACR,WAAW;gBACX,YAAY,CAAC,MAAM,iIAAQ,CAAC,IAAI,CAAC,OAAO,EAAE,EAAE,IAAI,CAAC,IAAI,CAAC,EAAE;YAC1D;SACD;QAED,2EAA2E;QAC3E,MAAM,iIAAQ,CACX,IAAI,CAAC,WACL,MAAM,CAAC;YAAE,QAAQ;QAAsB,GACvC,EAAE,CAAC,MAAM,OAAO,EAAE;QAErB,IAAI,CAAC,OAAO;YACV,MAAM;YACN;YACA,OAAO,QAAQ,CAAC,MAAM,IAAI,6CAA6C;QACzE,OAAO;YACL,MAAM;QACR;QACA,YAAY;IACd;IAEA,qBACE,qKAAC;QAAI,WAAU;kBACb,cAAA,qKAAC;YAAI,WAAU;;8BACb,qKAAC;oBAAG,WAAU;8BAA0C;;;;;;8BACxD,qKAAC;oBAAE,WAAU;;wBAA6B;wBAAU,OAAO,EAAE,CAAC,KAAK,CAAC,GAAG;;;;;;;8BAEvE,qKAAC;oBAAK,UAAU;oBAAmB,WAAU;;sCAC3C,qKAAC;;8CACC,qKAAC;oCAAM,WAAU;8CAA+B;;;;;;8CAChD,qKAAC;oCACC,OAAO;oCACP,UAAU,CAAC,IAAM,UAAU,EAAE,MAAM,CAAC,KAAK;oCACzC,WAAU;;sDAEV,qKAAC;sDAAO;;;;;;sDACR,qKAAC;sDAAO;;;;;;sDACR,qKAAC;sDAAO;;;;;;sDACR,qKAAC;sDAAO;;;;;;sDACR,qKAAC;sDAAO;;;;;;;;;;;;;;;;;;sCAIZ,qKAAC;;8CACC,qKAAC;oCAAM,WAAU;8CAA+B;;;;;;8CAChD,qKAAC;oCACC,OAAO;oCACP,UAAU,CAAC,IAAM,aAAa,EAAE,MAAM,CAAC,KAAK;oCAC5C,WAAU;oCACV,aAAY;;;;;;;;;;;;sCAIhB,qKAAC;4BAAI,WAAU;;8CACb,qKAAC;oCACC,MAAK;oCACL,SAAS;oCACT,WAAU;8CACX;;;;;;8CAGD,qKAAC;oCACC,MAAK;oCACL,UAAU;oCACV,WAAU;8CAET,WAAW,gBAAgB;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAO1C"}},
    {"offset": {"line": 242, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/sil/Documents/Reposit%C3%B3rios/paodequeijodaira/src/pages/pedidos.js"],"sourcesContent":["import { useEffect, useState } from 'react';\r\nimport Head from 'next/head';\r\nimport FormularioTroca from '../components/FormularioTroca'; \r\nimport { supabase } from '../lib/supabaseClient';\r\n\r\nexport default function Pedidos() {\r\n  const [pedidos, setPedidos] = useState([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [user, setUser] = useState(null);\r\n  const [pedidoParaTrocar, setPedidoParaTrocar] = useState(null);\r\n\r\n  useEffect(() => {\r\n    async function carregarDados() {\r\n      // 1. Verifica se h√° um usu√°rio logado\r\n      const { data: { user } } = await supabase.auth.getUser();\r\n      setUser(user);\r\n\r\n      if (user) {\r\n        // 2. Busca pedidos vinculados ao email ou √† carteira web3 salva no metadado\r\n        const { data, error } = await supabase\r\n          .from('pedidos')\r\n          .select('*')\r\n          .or(`cliente_email.eq.${user.email},wallet_address.eq.${user.user_metadata?.wallet || 'none'}`)\r\n          .order('created_at', { ascending: false });\r\n\r\n        if (!error) setPedidos(data);\r\n      }\r\n      setLoading(false);\r\n    }\r\n\r\n    carregarDados();\r\n  }, []);\r\n\r\n  // Componente interno para a etiqueta de status\r\n  const StatusBadge = ({ status }) => {\r\n    const estilos = {\r\n      'Preparando': 'bg-blue-100 text-blue-700',\r\n      'Saiu para Entrega': 'bg-orange-100 text-orange-700',\r\n      'Entregue': 'bg-green-100 text-green-700',\r\n      'Cancelado': 'bg-red-100 text-red-700',\r\n      'Em An√°lise de Troca': 'bg-purple-100 text-purple-700'\r\n    };\r\n    return (\r\n      <span className={`px-3 py-1 rounded-full text-xs font-bold ${estilos[status] || 'bg-gray-100'}`}>\r\n        {status}\r\n      </span>\r\n    );\r\n  };\r\n\r\n  if (loading) {\r\n    return (\r\n      <div className=\"min-h-screen flex items-center justify-center\">\r\n        <div className=\"animate-spin rounded-full h-12 w-12 border-t-2 border-orange-600\"></div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-gray-50 py-12 px-6\">\r\n      <Head>\r\n        <title>Meus Pedidos | P√£o de Queijo da Ir√°</title>\r\n      </Head>\r\n\r\n      <div className=\"max-w-3xl mx-auto\">\r\n        <header className=\"mb-10\">\r\n          <h1 className=\"text-3xl font-black uppercase tracking-tighter\">Meus Pedidos üì¶</h1>\r\n          <p className=\"text-gray-500\">Acompanhe suas compras de camisetas e acess√≥rios.</p>\r\n        </header>\r\n\r\n        {!user ? (\r\n          <div className=\"bg-white p-10 rounded-3xl text-center shadow-sm\">\r\n            <p className=\"text-gray-600 mb-6\">Voc√™ precisa estar logado para ver seu hist√≥rico.</p>\r\n            <button className=\"bg-black text-white px-8 py-3 rounded-full font-bold\">Fazer Login</button>\r\n          </div>\r\n        ) : pedidos.length === 0 ? (\r\n          <div className=\"bg-white p-10 rounded-3xl text-center shadow-sm\">\r\n            <p className=\"text-gray-500 italic\">Nenhum pedido encontrado.</p>\r\n          </div>\r\n        ) : (\r\n          <div className=\"space-y-4\">\r\n            {pedidos.map((pedido) => (\r\n              <div key={pedido.id} className=\"bg-white p-6 rounded-3xl shadow-sm border border-gray-100\">\r\n                <div className=\"flex justify-between items-start mb-4\">\r\n                  <div>\r\n                    <span className=\"text-xs font-bold text-gray-400 uppercase\">ID: {pedido.id.slice(0, 8)}</span>\r\n                    <p className=\"text-sm text-gray-500\">\r\n                      {new Date(pedido.created_at).toLocaleDateString('pt-BR')}\r\n                    </p>\r\n                  </div>\r\n                  <StatusBadge status={pedido.status} />\r\n                </div>\r\n\r\n                <div className=\"flex justify-between items-end\">\r\n                  <div>\r\n                    <h3 className=\"font-bold text-lg\">{pedido.resumo_itens || 'Produtos da Loja Ir√°'}</h3>\r\n                    <p className=\"text-orange-600 font-black text-xl\">R$ {pedido.total.toFixed(2)}</p>\r\n                  </div>\r\n\r\n                  <div className=\"flex gap-2\">\r\n                    {/* Bot√£o de Troca s√≥ aparece se o produto foi entregue */}\r\n                    {pedido.status === 'Entregue' && (\r\n                      <button \r\n                        onClick={() => setPedidoParaTrocar(pedido)}\r\n                        className=\"bg-gray-100 hover:bg-gray-200 text-gray-700 px-4 py-2 rounded-xl text-sm font-bold transition\"\r\n                      >\r\n                        Trocar / Devolver\r\n                      </button>\r\n                    )}\r\n                    <button className=\"border border-gray-200 hover:bg-gray-50 px-4 py-2 rounded-xl text-sm font-bold transition\">\r\n                      Ver Detalhes\r\n                    </button>\r\n                  </div>\r\n                </div>\r\n\r\n                {/* Exibi√ß√£o de comprovante Blockchain se houver */}\r\n                {pedido.tx_hash && (\r\n                  <div className=\"mt-4 pt-4 border-t border-gray-50 flex items-center justify-between\">\r\n                    <span className=\"text-[10px] text-gray-400 font-mono\">HASH: {pedido.tx_hash.slice(0, 16)}...</span>\r\n                    <a \r\n                      href={`https://polygonscan.com/tx/${pedido.tx_hash}`}\r\n                      target=\"_blank\"\r\n                      rel=\"noopener noreferrer\"\r\n                      className=\"text-xs text-purple-600 font-bold hover:underline\"\r\n                    >\r\n                      Ver na PolygonScan ‚Üó\r\n                    </a>\r\n                  </div>\r\n                )}\r\n              </div>\r\n            ))}\r\n          </div>\r\n        )}\r\n      </div>\r\n\r\n      {/* Modal de Troca/Devolu√ß√£o */}\r\n      {pedidoParaTrocar && (\r\n        <FormularioTroca \r\n          pedido={pedidoParaTrocar} \r\n          onFechar={() => setPedidoParaTrocar(null)} \r\n        />\r\n      )}\r\n    </div>\r\n  );\r\n                        }\r\n"],"names":[],"mappings":"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"}}]
}